# 🥇 AU9999 中国黄金价格 API 集成指南

## 📋 API 服务商对比

### 1. 极速数据 (jisuapi.com) ⭐ 推荐

**优点:**
- ✅ 免费会员: 100次/天
- ✅ 提供上海黄金交易所AU9999数据
- ✅ 包含买价、卖价、最高、最低、成交量
- ✅ 单位: 元/克 (符合国内习惯)
- ✅ 注册简单,无需认证

**API信息:**
- 接口地址: `https://api.jisuapi.com/gold/shgold`
- 请求方式: GET
- 参数: `appkey=你的密钥`

**返回数据结构:**
```json
{
  "status": "0",
  "msg": "ok",
  "result": [
    {
      "variety": "AU9999",
      "name": "黄金9999",
      "latestpri": "485.50",
      "openpri": "484.00",
      "maxpri": "486.50",
      "minpri": "483.00",
      "limit": "0",
      "yespri": "484.00",
      "totalvol": "12345.0",
      "time": "2025-10-19 14:30:00"
    }
  ]
}
```

---

### 2. 探数数据 (tanshuapi.com)

**优点:**
- ✅ 免费会员: 600次/月
- ✅ AU9999完整数据
- ✅ 每分钟更新(交易时段)
- ✅ 包含涨跌幅百分比

**缺点:**
- ⚠️ 需要实名认证
- ⚠️ 月配额较少(600次/月 ≈ 20次/天)

**API信息:**
- 需要注册并申请API key
- 具体接口地址需登录后查看

---

### 3. 天聚数行 (tianapi.com)

**优点:**
- ✅ 上海黄金交易所官方数据
- ✅ 支持批量查询多个品种
- ✅ 数据准确

**缺点:**
- ⚠️ 免费额度较少
- ⚠️ 需要API key

---

## 🚀 快速开始 - 极速数据 (推荐)

### 步骤1: 注册账号

1. 访问: https://www.jisuapi.com/
2. 点击右上角"注册"
3. 填写邮箱和密码
4. 验证邮箱
5. 登录后台

### 步骤2: 获取 AppKey

1. 登录后点击"控制台"
2. 进入"我的接口"
3. 找到"黄金价格API"并申请
4. 复制你的 AppKey (格式: xxxxxxxxxxxxxxxx)

### 步骤3: 测试接口

在浏览器中访问(替换YOUR_APPKEY):
```
https://api.jisuapi.com/gold/shgold?appkey=YOUR_APPKEY
```

如果返回JSON数据,说明成功!

---

## 💻 集成到你的网站

### 修改 script.js

找到 `fetchCommodityPrices()` 函数,替换为:

```javascript
// 极速数据 API Key (替换为你的)
const JISU_API_KEY = 'YOUR_APPKEY_HERE';

// 获取贵金属和原油价格
async function fetchCommodityPrices() {
    try {
        // 获取上海黄金交易所AU9999价格
        const goldResponse = await fetch(`https://api.jisuapi.com/gold/shgold?appkey=${JISU_API_KEY}`);
        const goldData = await goldResponse.json();

        if (goldData.status === '0' && goldData.result) {
            // 查找AU9999数据
            const au9999 = goldData.result.find(item => item.variety === 'AU9999');

            if (au9999) {
                const goldGramPriceCNY = parseFloat(au9999.latestpri); // 人民币/克
                const goldOzPriceCNY = goldGramPriceCNY * OZ_TO_GRAM; // 人民币/盎司

                // 计算涨跌幅
                const yespri = parseFloat(au9999.yespri);
                const changePercent = ((goldGramPriceCNY - yespri) / yespri * 100);

                // 换算成美元 (用于美元显示)
                const goldGramPriceUSD = goldGramPriceCNY / exchangeRate;
                const goldOzPriceUSD = goldOzPriceCNY / exchangeRate;

                // 更新显示
                updatePrice('gold-g', goldGramPriceUSD, changePercent);
                updatePrice('gold-oz', goldOzPriceUSD, changePercent);

                console.log(`✅ AU9999实时价格: ¥${goldGramPriceCNY}/克, 涨跌: ${changePercent.toFixed(2)}%`);
            }
        }

        // 白银价格 (如果API提供,可类似处理)
        const silverOzPriceUSD = 33 + (Math.random() - 0.5) * 2;
        const silverGramPriceUSD = silverOzPriceUSD / OZ_TO_GRAM;
        const silverChange = (Math.random() - 0.5) * 0.5;

        updatePrice('silver-oz', silverOzPriceUSD, silverChange);
        updatePrice('silver-g', silverGramPriceUSD, silverChange);

        // 原油价格
        const oilPriceUSD = 73 + (Math.random() - 0.5) * 4;
        const oilChange = (Math.random() - 0.5) * 1.5;
        updatePrice('oil', oilPriceUSD, oilChange);

    } catch (error) {
        console.error('获取大宗商品价格失败:', error);
        // 失败时使用PAXG作为备用
        fetchPAXGPrice();
    }
}

// PAXG备用方案
async function fetchPAXGPrice() {
    try {
        const response = await fetch('https://api.binance.com/api/v3/ticker/24hr?symbols=["PAXGUSDT"]');
        const data = await response.json();

        if (data[0] && data[0].symbol === 'PAXGUSDT') {
            const goldOzPriceUSD = parseFloat(data[0].lastPrice);
            const goldGramPriceUSD = goldOzPriceUSD / OZ_TO_GRAM;
            const changePercent = parseFloat(data[0].priceChangePercent);

            updatePrice('gold-oz', goldOzPriceUSD, changePercent);
            updatePrice('gold-g', goldGramPriceUSD, changePercent);
        }
    } catch (error) {
        console.error('PAXG备用方案也失败:', error);
    }
}
```

---

## ⚙️ 重要配置

### 1. API请求频率

极速数据免费版: 100次/天

**建议配置:**
- 每 **5秒** 更新一次 (17280次/天,超限!)
- 改为每 **2分钟** 更新一次 (720次/天,安全)
- 或每 **1分钟** 更新一次 (1440次/天,需升级)

**修改更新频率:**

在 `script.js` 最后找到:
```javascript
// 每秒更新一次价格
setInterval(updateAllPrices, 1000);
```

改为:
```javascript
// 每2分钟更新一次大宗商品价格 (节省API额度)
setInterval(fetchCommodityPrices, 120000); // 120秒

// BTC/ETH可以每秒更新 (币安无限制)
setInterval(fetchCryptoPrice, 1000);
```

### 2. 处理API配额用完

```javascript
async function fetchCommodityPrices() {
    try {
        const goldResponse = await fetch(`https://api.jisuapi.com/gold/shgold?appkey=${JISU_API_KEY}`);
        const goldData = await goldResponse.json();

        if (goldData.status !== '0') {
            console.warn('API返回错误:', goldData.msg);

            if (goldData.msg.includes('超过')) {
                // 配额用完,切换到PAXG备用
                console.log('切换到PAXG备用方案');
                fetchPAXGPrice();
            }
        }

        // ... 正常处理
    } catch (error) {
        console.error('API请求失败:', error);
        fetchPAXGPrice(); // 使用备用
    }
}
```

---

## 🎯 最佳实践方案

### 混合方案 (推荐)

1. **黄金**: 使用极速数据 AU9999 (国内价格)
2. **备用**: PAXG (国际价格,API失败时切换)
3. **BTC/ETH**: 币安API (免费无限制)
4. **白银/原油**: 模拟数据或其他API

### 更新策略

```javascript
// 黄金: 每2分钟更新 (节省API配额)
setInterval(fetchCommodityPrices, 120000);

// 加密货币: 每秒更新 (无限制)
setInterval(fetchCryptoPrice, 1000);

// 汇率: 每小时更新
setInterval(fetchExchangeRate, 3600000);
```

---

## 📞 获取帮助

**极速数据:**
- 官网: https://www.jisuapi.com/
- 文档: https://www.jisuapi.com/api/gold/
- 客服: 网站右下角在线客服

**探数数据:**
- 官网: https://www.tanshuapi.com/
- 文档: https://www.tanshuapi.com/market/detail-86

---

## ✅ 下一步

1. ✅ 注册极速数据账号
2. ✅ 获取AppKey
3. ✅ 测试接口是否正常
4. ✅ 把AppKey发给我
5. ✅ 我帮你完整集成到网站!

**准备好AppKey后告诉我,我立即帮你更新代码!** 🚀
